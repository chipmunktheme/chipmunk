<?php

namespace Chipmunk;

/**
 * Custom settings pages for the theme
 *
 * @package WordPress
 * @subpackage Chipmunk
 */
class Settings {

	/**
	 * License data object
	 *
	 * @var object
	 */
	public static $license;

	/**
 	 * Used to register custom hooks
	 *
	 * @return void
	 */
	function __construct() {
		add_action( 'admin_menu', array( $this, 'add_menu_page' ), 1 );
		add_action( 'chipmunk_settings_nav', array( $this, 'add_menu_page' ), 1 );

		// Initialize theme licenser
		$licenser = new Settings\Licenser( array(
			'remote_api_url' => THEME_SHOP_URL,
			'item_id'        => THEME_ITEM_ID,
			'item_name'      => THEME_TITLE,
			'item_slug'      => THEME_SLUG,
		) );

		// Store license data
		self::$license = $licenser->get_license_data();

		// Initialize other settings
		new Settings\Faker();
		new Settings\Addons();
	}

	/**
	 * Register settings page to the admin_menu action hook
	 */
	public function add_menu_page() {
		add_menu_page(
			THEME_TITLE,
			THEME_TITLE,
			'edit_theme_options',
			THEME_SLUG,
			array( $this, 'admin_settings' ),
			'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTI4cHgiIGhlaWdodD0iMTI2cHgiIHZpZXdCb3g9IjAgMCAxMjggMTI2IiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPgogICAgPHRpdGxlPmNoaXBtdW5rPC90aXRsZT4KICAgIDxnIGlkPSJQYWdlLTEiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSJjaGlwbXVuayIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTAuMDAwMDAwLCAxMC4wMDAwMDApIiBmaWxsPSIjQTdBQUFEIiBmaWxsLXJ1bGU9Im5vbnplcm8iPgogICAgICAgICAgICA8cGF0aCBkPSJNODQuNDM5MTI1LDEwNi4yMjgxMjUgTDg1LjE1MDQwNjMsMTA1LjY0NDI1IEM4Ni4yODM1NjI1LDEwNC43NjY3NSA4Ni43MzE1OTM4LDEwMy40Mzk1MzEgODYuNzU4NTkzOCwxMDAuODg5NzE5IEw4Ni43NTQzNzUsMTAwLjM1OTg0NCBDODYuNzMyNDM3NSw5OC44NzQ4NDM3IDg2LjU5NzQzNzUsOTguMjcwNzE4OCA4Ni4wOTk2MjUsOTcuMTcwNDY4OCBDODUuMDk4MDkzOCw5NS4wNDU5MDYzIDgzLjMwNTk2ODgsOTMuMTYwMTI1IDgxLjExODEyNSw5Mi4wMTg1MzEzIEw3OS4yNzM2ODc1LDkxLjAzNTU2MjUgTDgwLjMwMTM3NSw4OS4xMjM2MjUgQzgzLjQ2Mzc1LDgzLjI3OTgxMjUgODQuODA3ODQzOCw3Ni44NzkxMjUgODQuMDE3MjUsNzEuMjc0OTM3NSBMODMuNjc0Njg3NSw2OC44ODM3NSBMODQuNDM5MTI1LDY4LjM1MjE4NzUgQzg1Ljc4MzIxODgsNjcuMzk3MDYyNSA4Ny45OTcyMTg4LDY1LjIxODUgODguOTQ1NTkzOCw2My45MTc0Mzc1IEw4OS44Njc4MTI1LDYyLjY0MjUzMTMgTDkyLjM3MjA2MjUsNjIuNjQyNTMxMyBDOTMuNzQ5MDYyNSw2Mi42NDI1MzEzIDk1LjU5MDk2ODgsNjIuODIwNTYyNSA5Ny4xMjY1OTM4LDYzLjExNjcxODggTDk3LjUzNzUsNjMuMjAwMjUgQzEwMC43NTIxODgsNjMuODY0MjgxMyAxMDIuMTIzMjgxLDYzLjc1Nzk2ODggMTAzLjQxNDIxOSw2Mi43NzUgQzEwNS4zOTExMjUsNjEuMjYxMzEyNSAxMDUuOTcwNzgxLDU3Ljg4OCAxMDQuNzA1MTU2LDU1LjMxMjAzMTMgQzEwMi42NjU4MTMsNTEuMjAwNDM3NSA5OC4yNDk2MjUsNDguMzEzMTI1IDkzLjMzODE1NjMsNDcuODcyNjg3NSBMOTIuMjg1MTU2Myw0Ny43OTA4NDM4IEM5MC44MjU0Njg4LDQ3LjY2ODUgOTAuNzQ5NTMxMyw0Ny41NTYyODEzIDkwLjQ3NDQ2ODgsNDYuODM5MDkzOCBDOTAuMjc3MDMxMyw0Ni40MTcyMTg4IDkwLjAzNDg3NSw0NS4zNzA5Njg4IDg5Ljg5NjUsNDQuNDM0NDA2MyBMODkuNjMwNzE4OCw0Mi40NTY2NTYzIEw5MC45NzQ4MTI1LDQyLjQ1NjY1NjMgQzkzLjQ1MjA2MjUsNDIuNDU2NjU2MyA5OC4zNTQyNSw0MS44OTg5Mzc1IDEwMC41OTM1NjMsNDEuMzY4MjE4OCBDMTA1LjU3NTA2Myw0MC4xOTg3ODEzIDEwOCwzOC4yODY4NDM4IDEwOCwzNS41NTA1NjI1IEMxMDgsMzMuNzk4MDkzOCAxMDcuMTMwOTM4LDI5Ljg0MDA2MjUgMTA2LjI4NzE4OCwyNy43MTU1IEMxMDQuNjI2Njg4LDIzLjU0NTY4NzUgMTAyLjIyODc1LDIwLjU0MzYyNSA5OC41MTIwMzEzLDE4LjA0Njk2ODggQzk1LjAwNzA5MzgsMTUuNjgzNjI1IDkxLjM0MzUzMTMsMTQuNDA4NzE4NyA4Ni4wNDY0Njg4LDEzLjY5MTUzMTIgTDgzLjcwMDg0MzgsMTMuMzcyNTkzOCBMODIuNzMwNTMxMywxMC40ODEwNjI1IEM4Mi4xNjY5MDYzLDguODQ5MjUgODEuODU3MjUsOC4yMzU4NDM3NSA4MC43ODQ4NDM4LDYuNjUyOTY4NzUgTDgwLjI3NTIxODgsNS45MDk2MjUgQzc4Ljc0NjM0MzgsMy42MjQ3NSA3NS40MjUzNDM4LDAuMzMxNTkzNzUgNzQuNDUwODEyNSwwLjA5MjgxMjUgQzcyLjg2MzcxODgsLTAuMzIwNjI1IDcxLjMyNTU2MjUsMC44MjA5Njg3NSA2OS41MjMzMTI1LDMuNzM1MjgxMjUgTDY5LjM2Mzg0MzgsMy45OTY4NDM3NSBDNjcuMTk2MjUsNy41NTMyNSA2Ni4yMzM1MzEzLDExLjQ5OTQ2ODggNjUuODUzODQzOCwxOC4zNDM5Njg3IEw2NS43NTA5MDYzLDIwLjQyNDY1NjMgQzY1LjQ4NzY1NjMsMjUuMzk3NzE4NyA2NS4wNDM4NDM4LDI4Ljk3MDE1NjMgNjQuMjg0NDY4OCwzMi4yNjQxNTYzIEw2NC4xOTg0MDYzLDMyLjYyODY1NjMgQzYzLjY0NDkwNjMsMzQuOTQwNTMxMyA2Mi42OTY1MzEzLDM3Ljc4MTQzNzUgNjIuNTM4NzUsMzcuNjIyODEyNSBDNjIuNDg1NTkzOCwzNy41Njk2NTYzIDYyLjYxNzIxODgsMzYuNDUzMzc1IDYyLjg1NDMxMjUsMzUuMTUyMzEyNSBDNjMuNzUwMzc1LDI5LjkyMDIxODggNjIuNTkxMDYyNSwyMy4xNDY1OTM4IDU5Ljg3NTg3NSwxNy42NzU3MTg4IEM1NS41NTUwMzEzLDkuMDQ0MTU2MjUgNDcuNzI3NTYyNSwyLjg4MTQwNjI1IDM4LjQyNDM3NSwwLjcyOTg0Mzc1IEMzNi40MTYyNSwwLjI2MzI1IDI5LjgzMjQ2ODgsLTAuMTc4ODc1IDI4LjQ5NTk2ODgsMC4wNzM0MDYyNSBMMjguMzAwMjE4OCwwLjExNjQzNzUgQzI3LjU0ODU2MjQsMC4yNTY4NTkzIDI2Ljc5NDA4OTQsMC4zODE3NjA4NjkgMjYuMDM3MjgxMywwLjQ5MTA2MjUgQzE2LjY1NDc4MTMsMi4wMzE3NSA3Ljc3MzQ2ODc1LDguNjcxMjE4NzUgMy4zNzI0Njg3NSwxNy40ODkyNSBDMS4zMTM3MTg3NSwyMS41ODczNDM4IDAuMzMzMjgxMjUsMjUuMzE1MDMxMyAwLjA3NTkzNzUsMzAuMTAwNzgxMyBMMC4wNTA2MjUsMzAuNjM3NDA2MyBDLTAuMTI5OTM3NSwzNC44MTgxODc1IDAuMTE4MTI1LDM1LjkyNjg3NSAxLjUwOTQ2ODc1LDM2LjY0NDkwNjIgTDEuNjA1NjU2MjUsMzYuNjkzIEMyLjg2Mjg0Mzc1LDM3LjMxNCAzLjcyODUzMTI1LDM3LjA3NTIxODggNS4zMDEyODEyNSwzNS40OTgyNSBMNS42Mzc5Mzc1LDM1LjE1MjMxMjUgQzYuNTQ2MTI3MDEsMzQuMTgxMzA1MiA3LjYyNzgzMDQyLDMzLjM4ODYyODQgOC44MjczMTI1LDMyLjgxNTEyNSBMOS4xOTY4NzUsMzIuNjQzIEMxMC40MjAzMTI1LDMyLjA4NjEyNSAxMC45NDM0Mzc1LDMxLjk4MDY1NjMgMTIuNjEzMjE4OCwzMS45NjcxNTYzIEwxMy42MzI0Njg4LDMxLjk2NzE1NjMgQzE1LjQ2MDAzMTMsMzEuOTgyMzQzOCAxNS45MTMxMjUsMzIuMTA2Mzc1IDE3LjM5MjIxODgsMzIuODE1MTI1IEMxOS43OTAxNTYzLDMzLjk1NjcxODggMjEuMzcxMzQzOCwzNS40OTgyNSAyMi41MDUzNDM4LDM3LjgwODQzNzUgQzI0LjA1OTUzMTMsNDAuOTk1MjgxMyAyNC4wMzMzNzUsNDUuMDU5NjI1IDIyLjQ1MjE4NzUsNDcuMTg0MTg3NSBMMjIuMzYyNzUsNDcuMjgwMzc1IEMyMS44MTAwOTM4LDQ3LjgzMzAzMTMgMTkuNjc0NTYyNSw0OS40MTE2ODc1IDE3LjM2MDE1NjMsNTAuOTYwODEyNSBMMTcuMTI4MTI1LDUxLjExNTIxODggQzE0LjA4MzAzMTMsNTMuMTM2IDEyLjAxNSw1NC43MTI5Njg4IDEwLjc2MDM0MzgsNTUuOTY1MDkzOCBMMTAuNjE4NTkzOCw1Ni4xMDg1MzEzIEM3LjE5Mjk2ODc1LDU5LjU4ODE1NjMgNC43MTU3MTg3NSw2NC4wNDk5MDYzIDMuMzE4NDY4NzUsNjkuMjAzNTMxMyBDMi41Mjc4NzUsNzIuMTc3NzUgMi41MDE3MTg3NSw3OS4xMDkxNTYzIDMuMjkzMTU2MjUsODIuMDMxOTA2MyBDNC43NjgwMzEyNSw4Ny40NDk2MjUgNy4xNjU5Njg3NSw5MS43NTE5MDYzIDEwLjcyNDA2MjUsOTUuMzM3ODQzOCBDMTcuOTE5NTYyNSwxMDIuNTg5MDMxIDI4Ljc1MDc4MTMsMTA1LjM1MTQ2OSAzNy43MTE0MDYzLDEwMi4yNDM5MzggTDM5LjE4Nzk2ODgsMTAxLjczOTM3NSBMNDIuNDI4ODEyNSwxMDMuMzU5Mzc1IEw0NC4xOTE0MDYzLDEwNC4yNTk2NTYgQzQ3LjIyODkwNjMsMTA1Ljc4MTc4MSA0OC41NTUyODEzLDEwNi4wMzMyMTkgNTcuOTIzNDM3NSwxMDYuMTA3NDY5IEw4NC40MzgyODEzLDEwNi4yMjgxMjUgTDg0LjQzOTEyNSwxMDYuMjI4MTI1IFogTTgwLjYyMzY4NzUsMTAwLjE4MjY1NiBMNzkuODQ0OTA2MiwxMDAuMjUwMTU2IEM3OC4zNDM4NzUsMTAwLjM1OSA3NS42NjY2NTYyLDEwMC4zNjQwNjMgNzEuMDY4MjE4NywxMDAuMzYxOTY3IEw1OS4zODIyODEyLDEwMC4zNTQ3ODEgQzQ5LjU0MTYyNSwxMDAuMzIxMDMxIDQ4LjI0OSwxMDAuMDM5MjE5IDQ0LjIxMzM0MzcsOTcuODAwNzUgTDQyLjA3Njk2ODcsOTYuNjAyNjI1IEM0MC4zNDY0Mzc1LDk1LjY0NzUgMzkuOTI1NDA2Miw5NS42ODEyNSAzNi4yOTcyODEyLDk2Ljc2OCBDMzEuNDQ2NTYyNSw5OC4yMzM1OTM3IDI2LjM3OSw5Ny44NjMxODc1IDIxLjkwOTY1NjIsOTYuMDAwMTg3NSBDMTcuMzA0MzQ4OCw5NC4wODE3NTAxIDEzLjQ5MzExNjMsOTAuNjQ2ODE4IDExLjEwNzk2ODcsODYuMjY1IEM5LjExMzY5MTcxLDgyLjU4OTg1ODQgOC4xOTgyMjQyLDc4LjQyNjA4OTkgOC40NjcwMzEyNSw3NC4yNTMzNzUgQzguNzI3NzUsNzAuMTU2MTI1IDEwLjExNTcxODcsNjYuMTQyNDA2MyAxMi41OTg4NzUsNjIuNzQ0NjI1IEwxMi44OTA4MTI1LDYyLjM1MTQzNzUgQzE0LjYyNDcxODcsNjAuMDUyMjE4OCAxNi4xNTE5MDYyLDU4Ljc4ODI4MTMgMjAuMzQ3MDMxMiw1Ni4wMTkwOTM4IEwyMS4wNDk4NzUsNTUuNTQxNTMxMyBDMjMuMTYzNDY4Nyw1NC4wOTAyODEzIDI1LjI2MjcxODcsNTIuNTExNjI1IDI1Ljg4OTYyNSw1MS44NTUxODc1IEMyNy44OTE4NDM3LDQ5Ljc4MjA5MzggMjkuMDY2MzQzNyw0Ni45NDg3ODEzIDI5LjM0OSw0My44OTM1NjI1IEMyOS42MjgyODEyLDQwLjg2MzY1NjMgMjkuMDMwOTA2MiwzNy42MTYwNjI1IDI3LjUwNTQwNjIsMzQuNjkyNDY4OCBDMjYuMjIyOTA2MiwzMi4yNDY0Mzc1IDIzLjAwNzM3NSwyOS4wODc0Mzc1IDIwLjU1Mzc1LDI3Ljg1MTM0MzggQzE2LjA3MjU5MzcsMjUuNTc5MTI1IDExLjc5NjQ2ODcsMjUuNDM2NTMxMyA2LjYxMTYyNSwyNy4zNzA0MDYzIEw2LjY1OTcxODc1LDI3LjExMjIxODggQzYuOTk1NTMxMjUsMjUuMDgyMTU2MyA4LjEwNzU5Mzc1LDIxLjg1NjUgOS4yNjk0Mzc1LDE5LjU5MjcxODggQzEyLjgzMzQzNzUsMTIuNTkxMjgxMyAxOS40MTgwNjI1LDcuNjc1NTkzNzUgMjcuMjY2NjI1LDYuMTY2MTI1IEMzMC4wNTUyMTg3LDUuNjQ1NTMxMjUgMzQuOTU4MjUsNS44NTY0Njg3NSAzOC4wNTQ4MTI1LDYuNjYyMjUgQzQ1LjE0NDg0MzcsOC41MTAwNjI1IDUwLjc2ODQzNzUsMTMuMTcwOTM3NSA1NC4wNzQyNSwxOS4xMTE3ODEzIEM1Ny4zNzgzNzUsMjUuMDUwMDkzOCA1OC4zNjY0MDYyLDMyLjI3MDA2MjUgNTYuMTg1MzEyNSwzOS4yNDE5Njg4IEM1NS43Njk0ODk2LDQwLjUyNzAxNzIgNTUuMjY0ODM1Niw0MS43ODE2MDM5IDU0LjY3NSw0Mi45OTY2NTYzIEM1NC40MTAwNjI1LDQzLjU0MDAzMTMgNTQuMTU2OTM3NSw0NC4wMDI0MDYzIDUzLjk0NDMxMjUsNDQuMzIxMzQzOCBDNTMuOTIyMzc1LDQ0LjM1MzQwNjMgNTMuOTMyNSw0NC41ODEyMTg4IDUzLjg5MzY4NzUsNDQuNTgxMjE4OCBMNTMuNzYyMDYyNSw0NC41OTEzNDM4IEM1My42MTI3MTg3LDQ0LjYwNjUzMTMgNTMuMzU3MDYyNSw0NC42Mzg1OTM4IDUzLjAzMjIxODcsNDQuNjgxNjI1IEw1MC45OTU0MDYyLDQ0Ljk1OTIxODggQzQ0Ljg3ODIxODcsNDUuODkxNTYyNSAzOS40MjU5MDYyLDQ4LjYyMzYyNSAzNS4xNTMxNTYyLDUyLjY2MTgxMjUgQzMwLjg4MTI1LDU2LjY5OTE1NjMgMjcuNzg3MjE4Nyw2Mi4wNDQzMTI1IDI2LjM5MzM0MzcsNjguMjA3OTA2MyBDMjUuODU1MDMxMiw3MC42MjEwMzEzIDI1Ljc3NTcxODcsNzcuNTUzMjgxMyAyNi4yNjAwMzEyLDc5Ljg4NzA5MzggQzI2LjcxNTY1NjIsODEuOTg1NSAyNy4xNTYwOTM3LDgzLjMzMjk2ODggMjcuNzAwMzEyNSw4NC4xNjE1MzEzIEMyOC4zMzMxMjUsODUuMTI1OTM3NSAyOS4xMDA5Mzc1LDg1LjQ4NDUzMTMgMzAuMTc1MDMxMiw4NS40ODQ1MzEzIEMzMC45MjkzNDM3LDg1LjQ4NDUzMTMgMzEuNDg5NTkzNyw4NS4zNDEwOTM3IDMxLjkzMjU2MjUsODUuMDU1OTA2MyBDMzIuMzQwOTM3NSw4NC43OTI2NTYzIDMyLjY1OTAzMTIsODQuNDAzNjg3NSAzMi45MTk3NSw4My44NDUxMjUgTDMzLjA4MTc1LDgzLjQ2NjI4MTMgQzMzLjQxMDgxMjUsODIuNjY0NzE4OCAzMy4zOTM5Mzc1LDgyLjI2OSAzMi44MjAxODc1LDgwLjA5NDY1NjMgQzMyLjAyMiw3Ni45Mjg5MDYzIDMyLjAyMDMxMjUsNzEuNTMzMTI1IDMyLjgxNzY1NjIsNjguNDkzOTM3NSBDMzQuNjIxNTkzNyw2MS44NzA1IDM5LjE1NDIxODcsNTYuMjg0ODc1IDQ1LjEwNzcxODcsNTMuMzczOTM3NSBDNDcuNzg0MDkzNyw1Mi4wODcyMTg4IDUwLjQxMzIxODcsNTEuMzY2NjU2MyA1My42MzgwMzEyLDUxLjAzIEw1NC4xNTE4NzUsNTAuOTgwMjE4OCBDNjAuNTg3MTU2Miw1MC4zNzUyNSA2My44NTc1MzEyLDQ4LjE3NjQzNzUgNjYuODAxMzc1LDQyLjQzNDcxODggQzY5LjY0NjUsMzYuODg0NTMxMyA3MS4wOTUyMTg3LDMwLjI3ODgxMjUgNzEuNTc3LDIwLjIzMjI4MTMgTDcxLjY3MTUsMTguMjE3NDA2MyBDNzEuODMxODEyNSwxNS4xMDkwMzEzIDcyLjAyNDE4NzUsMTMuMzk5NTkzOCA3Mi4zNjg0Mzc1LDEyLjA3NDkwNjMgTDcyLjQwNTU2MjUsMTEuOTM0ODQzOCBDNzIuNjgyMzQzMiwxMC44MzU1ODQ5IDczLjAzNzYzMDEsOS43NTc1OTkxNiA3My40Njg2ODc1LDguNzA5MTg3NSBMNzMuNzc1ODEyNSw3Ljk4NjkzNzUgQzczLjgzODQzODksNy44Mzc0NjIyNiA3My44OTY0MDQzLDcuNjg2MDc2NjggNzMuOTQ5NjI1LDcuNTMzIEw3My45NDQ1NjI1LDcuNDg0OTA2MjUgQzczLjk0MTE4NzUsNy40NDYwOTM3NSA3My45Mzg2NTYyLDcuMzk2MzEyNSA3My45NDk2MjUsNy4zOTYzMTI1IEM3NC4wOTQ3NSw3LjM5NjMxMjUgNzQuNDQ0MDYyNSw4LjAzNTAzMTI1IDc0Ljg2Njc4MTMsOC42NCBMNzQuOTUyODQzNyw4Ljc2MDY1NjI1IEM3NS42MjM2MjUsOS42ODg3ODEyNSA3Ni4zNzg3ODEzLDEwLjg2NjY1NjMgNzYuODgwODEyNSwxMS44MDk5Njg4IEM3Ny4zMzk4MTI1LDEyLjcwODU2MjUgNzcuOTAwOTA2MywxNC4xMjAxNTYzIDc4LjEzMjA5MzgsMTQuOTIwODc1IEw3OC4zMzEyMTg3LDE1LjYzMjE1NjMgQzc4Ljc1ODE1NjIsMTcuMTA2MTg3NSA3OS4xMTMzNzUsMTcuODg3NSA3OS43NjIyMTg4LDE4LjM2MzM3NSBDODAuNDkzNzUsMTguODk4MzEyNSA4MS42NDEyNSwxOS4wNDUxMjUgODMuOTA4NDA2MywxOS4xODg1NjI1IEM4OS43ODQyODEzLDE5LjUyNDM3NSA5NC4xMzM4MTI1LDIxLjE4NTcxODggOTcuMjQyMTg3NSwyNC4zNDM4NzUgQzk5Ljc3ODUsMjYuOTAwNDM3NSAxMDEuMzQzNjU2LDI5LjkzMzcxODggMTAxLjg2MzQwNiwzMy4zMDc4NzUgTDEwMi4wNzA5NjksMzQuNzUzMjE4OCBMMTAxLjMyOTMxMywzNS4wOTE1NjI1IEwxMDEuMjUzMzc1LDM1LjEyMzYyNSBDOTkuNTUxNTMxMiwzNS44NDA4MTI1IDk2LjI1NzUzMTIsMzYuMzE5MjE4OCA5MS44NTE0Njg3LDM2LjUwMjMxMjUgTDkwLjM1MTI4MTIsMzYuNTU3MTU2MyBDODcuNDgwODQzNywzNi42NzEwNjI1IDg1Ljc4OTEyNSwzNi44NjQyODEzIDg1LjMzNjg3NSwzNy4wOTM3ODEzIEM4NC42MTg4NDM3LDM3LjQ1NjU5MzggODQuMTgzNDY4NywzNy45NDE3NSA4My45NTk4NzUsMzguOTI4OTM3NSBDODMuNzg0Mzc1LDM5LjcwODU2MjUgODMuNzU0LDQwLjg1Nzc1IDgzLjgyMDY1NjIsNDIuNjM2Mzc1IEw4My44MzMzMTI1LDQyLjk1NyBDODMuOTkzNjI1LDQ2Ljk2NDgxMjUgODQuNTk4NTkzNyw0OS4xMDM3MTg4IDg2LjAzNDY1NjIsNTAuODQ1MjE4OCBMODYuMTcxMzQzNyw1MS4wMDcyMTg4IEM4Ny41MjcyNSw1Mi42MTg3ODEzIDg4Ljc5MTE4NzUsNTMuMjI3MTI1IDkxLjYyMjgxMjUsNTMuNTczOTA2MyBMOTEuOTIxNSw1My42MDkzNDM4IEM5NC42ODksNTMuODk5NTkzOCA5Ni42NTQ5Mzc1LDU0LjczOTk2ODggOTguMjk1MTg3NSw1Ni4zOTU0MDYzIEw5OC40OTAwOTM3LDU2LjU5NzkwNjMgTDk4LjU2NjAzMTIsNTYuNjgyMjgxMyBDOTguODAzOTY4Nyw1Ni45NTE0Mzc1IDk5LjAwNTYyNSw1Ny4xOTk1IDk5LjE2ODQ2ODcsNTcuNDI0NzgxMyBMOTkuMjgyMzc1LDU3LjU5MSBMOTkuMzExOTA2Miw1Ny42MzU3MTg4IEw5OC4xMjcyODEyLDU3LjI5NjUzMTMgQzk2LjI3MTAzMTIsNTYuNzczNDA2MyA4OC4xNTkyMTg3LDU2LjgzOTIxODggODcuMDc1ODQzNyw1Ny4zODU5Njg4IEM4Ni42NDMsNTcuNjA1MzQzOCA4NS43MjgzNzUsNTguNTc1NjU2MyA4NC45OTY4NDM3LDU5LjYzNjI1IEw4NC41MTY3NSw2MC4zNTAwNjI1IEM4My4yNTExMjUsNjIuMTg1MjE4OCA4Mi4yNzc0Mzc1LDYzLjA2MTAzMTMgODAuMzIxNjI1LDY0LjI1NzQ2ODggTDc5Ljg4Mjg3NSw2NC41MjY2MjUgQzc4Ljc4MDA5MzcsNjUuMjE2ODEyNSA3OC4yMTU2MjUsNjUuNzEyMDkzOCA3Ny45NTA2ODc1LDY2LjM4ODc4MTMgQzc3LjY3NDc4MTIsNjcuMDkzMzEyNSA3Ny43MzMsNjguMDI1NjU2MyA3Ny45OTc5Mzc1LDY5LjcwNzI1IEw3OC4wNDE4MTI1LDY5Ljk3OTc4MTMgQzc4LjU4MzUsNzMuMzYxNTMxMiA3OC41ODYwMzEyLDc1LjY3ODQ2ODggNzguMDk1ODEyNSw3OC42MTk3ODEzIEM3Ny40NTExODc1LDgyLjMxNjI1IDc2LjMwNzA2MjUsODUuMzE5MTU2MiA3NC4yMzIyODEyLDg4LjYxMzE1NjIgTDczLjk1NzIxODcsODkuMDQ1MTU2MyBDNzIuODQwOTM3NSw5MC43NzgyMTg3IDcyLjQ4MDY1NjMsOTEuOTE5ODEyNSA3Mi43NzU5Njg3LDkyLjg1NzIxODggQzczLjA1NDQwNjIsOTMuNzQyMzEyNSA3My45NTMsOTQuNTA0MjE4NyA3NS43MTcyODEyLDk1LjM3OTE4NzUgTDc1Ljk2MjgxMjUsOTUuNDk5IEM3OC4yNTEwNjI1LDk2LjYwNDMxMjUgNzkuODM1NjI1LDk3LjgyNzc1IDgwLjU2MTI1LDk5LjEzMTM0MzcgTDgwLjcyOTE1NjIsOTkuNDQ5NDM3NSBMODAuOTk2NjI1LDk5LjkyMTkzNzUgQzgxLjAzMjA2MjUsOTkuOTg0Mzc1IDgxLjA2MjQzNzUsMTAwLjA0MjU5NCA4MS4wODQzNzUsMTAwLjA5NjU5NCBDODAuOTg3MzQzNywxMDAuMTQyMTU2IDgwLjgzMjkzNzUsMTAwLjE2MzI1IDgwLjYyMzY4NzUsMTAwLjE4MjY1NiBaIiBpZD0iU2hhcGUiPjwvcGF0aD4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==',
		);
	}

	/**
	 * Outputs the markup used on the theme settings page.
	 */
	public function admin_settings() {
		$tabs = apply_filters( 'chipmunk_settings_tabs', array() );
		?>

		<div class="chipmunk">
			<div class="chipmunk__head chipmunk__wrap">
				<h1 class="chipmunk__title">
					<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 128 126">
						<path d="m100.076 125.9.843-.692c1.343-1.04 1.874-2.613 1.906-5.635l-.005-.628c-.026-1.76-.186-2.476-.776-3.78-1.187-2.518-3.311-4.753-5.904-6.106l-2.186-1.165 1.218-2.266c3.748-6.926 5.341-14.512 4.404-21.154l-.406-2.834.906-.63c1.593-1.132 4.217-3.714 5.341-5.256l1.093-1.511h2.968c1.632 0 3.815.211 5.635.562l.487.099c3.81.787 5.435.661 6.965-.504 2.343-1.794 3.03-5.792 1.53-8.845-2.417-4.873-7.651-8.295-13.472-8.817l-1.248-.097c-1.73-.145-1.82-.278-2.146-1.128-.234-.5-.521-1.74-.685-2.85l-.315-2.344h1.593c2.936 0 8.746-.661 11.4-1.29 5.904-1.386 8.778-3.652 8.778-6.895 0-2.077-1.03-6.768-2.03-9.286-1.968-4.942-4.81-8.5-9.215-11.459-4.154-2.801-8.496-4.312-14.774-5.162l-2.78-.378-1.15-3.427c-.668-1.934-1.035-2.661-2.306-4.537l-.604-.881C93.329 4.296 89.393.393 88.238.11c-1.881-.49-3.704.863-5.84 4.317l-.189.31c-2.569 4.215-3.71 8.892-4.16 17.004l-.122 2.466c-.312 5.894-.838 10.128-1.738 14.032l-.102.432c-.656 2.74-1.78 6.107-1.967 5.919-.063-.063.093-1.386.374-2.928 1.062-6.201-.312-14.229-3.53-20.713C65.843 10.719 56.566 3.415 45.54.865 43.16.312 35.357-.212 33.773.087l-.232.051a65.9 65.9 0 0 1-2.682.444C19.739 2.408 9.213 10.277 3.997 20.728 1.557 25.585.395 30.003.09 35.675l-.03.636c-.214 4.955.08 6.269 1.729 7.12l.114.057c1.49.736 2.516.453 4.38-1.416l.399-.41a12.643 12.643 0 0 1 3.78-2.77l.438-.204c1.45-.66 2.07-.785 4.049-.801h1.208c2.166.018 2.703.165 4.456 1.005 2.842 1.353 4.716 3.18 6.06 5.918 1.842 3.777 1.811 8.594-.063 11.112l-.106.114c-.655.655-3.186 2.526-5.929 4.362l-.275.183c-3.609 2.395-6.06 4.264-7.547 5.748l-.168.17c-4.06 4.124-6.996 9.412-8.652 15.52-.937 3.525-.968 11.74-.03 15.204 1.748 6.421 4.59 11.52 8.807 15.77 8.528 8.594 21.365 11.868 31.985 8.185l1.75-.598 3.841 1.92 2.089 1.067c3.6 1.804 5.172 2.102 16.275 2.19l31.425.143Zm-4.522-7.165-.923.08c-1.779.129-4.952.135-10.402.132l-13.85-.008c-11.663-.04-13.195-.374-17.978-3.027l-2.532-1.42c-2.051-1.132-2.55-1.092-6.85.196-5.749 1.737-11.755 1.298-17.052-.91a25.927 25.927 0 0 1-12.802-11.538 26.303 26.303 0 0 1-3.13-14.236c.309-4.856 1.954-9.613 4.897-13.64l.346-.466c2.055-2.725 3.865-4.223 8.837-7.505l.833-.566c2.505-1.72 4.993-3.591 5.736-4.369 2.373-2.457 3.765-5.815 4.1-9.436.331-3.591-.377-7.44-2.185-10.905-1.52-2.899-5.331-6.643-8.239-8.108-5.311-2.693-10.379-2.862-16.524-.57l.057-.306c.398-2.406 1.716-6.229 3.093-8.912 4.224-8.298 12.028-14.124 21.33-15.913 3.305-.617 9.116-.367 12.786.588 8.403 2.19 15.068 7.714 18.986 14.755 3.916 7.038 5.087 15.595 2.502 23.858a34.54 34.54 0 0 1-1.79 4.45c-.314.644-.614 1.192-.866 1.57-.026.038-.014.308-.06.308l-.156.012c-.177.018-.48.056-.865.107l-2.414.329c-7.25 1.105-13.712 4.343-18.776 9.129-5.063 4.785-8.73 11.12-10.382 18.425-.638 2.86-.732 11.076-.158 13.842.54 2.487 1.062 4.084 1.707 5.066.75 1.143 1.66 1.568 2.933 1.568.894 0 1.558-.17 2.083-.508.484-.312.861-.773 1.17-1.435l.192-.449c.39-.95.37-1.419-.31-3.996-.946-3.752-.948-10.147-.003-13.749 2.138-7.85 7.51-14.47 14.566-17.92 3.172-1.525 6.288-2.379 10.11-2.778l.609-.059c7.627-.717 11.503-3.323 14.992-10.128 3.372-6.578 5.089-14.407 5.66-26.314l.112-2.388c.19-3.684.418-5.71.826-7.28l.044-.166a28.09 28.09 0 0 1 1.26-3.823l.364-.856a9.27 9.27 0 0 0 .206-.538l-.006-.057c-.004-.046-.007-.105.006-.105.172 0 .586.757 1.087 1.474l.102.143c.795 1.1 1.69 2.496 2.285 3.614.544 1.065 1.209 2.738 1.483 3.687l.236.843c.506 1.747.927 2.673 1.696 3.237.867.634 2.227.808 4.914.978 6.964.398 12.119 2.367 15.803 6.11 3.006 3.03 4.861 6.625 5.477 10.624l.246 1.713-.879.401-.09.038c-2.017.85-5.921 1.417-11.143 1.634l-1.778.065c-3.402.135-5.407.364-5.943.636-.851.43-1.367 1.005-1.632 2.175-.208.924-.244 2.286-.165 4.394l.015.38c.19 4.75.907 7.285 2.609 9.349l.162.192c1.607 1.91 3.105 2.631 6.461 3.042l.354.042c3.28.344 5.61 1.34 7.554 3.302l.231.24.09.1c.282.319.521.613.714.88l.135.197.035.053-1.404-.402c-2.2-.62-11.814-.542-13.098.106-.513.26-1.597 1.41-2.464 2.667l-.569.846c-1.5 2.175-2.654 3.213-4.972 4.631l-.52.319c-1.307.818-1.976 1.405-2.29 2.207-.327.835-.258 1.94.056 3.933l.052.323c.642 4.008.645 6.754.064 10.24-.764 4.381-2.12 7.94-4.579 11.844l-.326.512c-1.323 2.054-1.75 3.407-1.4 4.518.33 1.049 1.395 1.952 3.486 2.989l.291.142c2.712 1.31 4.59 2.76 5.45 4.305l.199.377.317.56c.042.074.078.143.104.207-.115.054-.298.079-.546.102Z"/>
					</svg>
					<?php echo THEME_TITLE; ?>
				</h1>

				<?php if ( ! empty( self::$license ) && 'valid' == self::$license->license ) : ?>
					<a href="<?php echo THEME_SHOP_URL; ?>/account" target="_blank" class="chipmunk__status">
						<div class="chipmunk__status-icon">
							âœ“
						</div>

						<div class="chipmunk__status-content">
							<?php if ( ! empty( self::$license->price_id ) ) : ?>
								<strong><?php printf( esc_html__( '%s License', 'chipmunk' ), THEME_PLANS[ self::$license->price_id ] ); ?></strong><br>
							<?php endif; ?>
							<?php echo esc_html( self::$license->customer_email ); ?>
						</div>
					</a>
				<?php endif; ?>
			</div>

			<div class="chipmunk__nav chipmunk__wrap">
				<ul>
					<?php foreach ( $tabs as $tab ) : ?>
						<li><a href="?page=chipmunk&tab=<?php echo esc_attr( $tab['slug'] ); ?>" <?php echo $this->is_active_tab( $tabs, $tab ) ? 'class="active"' : ''; ?>><?php echo esc_html( $tab['name'] ); ?></a></li>
					<?php endforeach; ?>
				</ul>
			</div>

			<div class="chipmunk__main chipmunk__wrap">
				<?php settings_errors(); ?>

				<?php foreach ( $tabs as $index => $tab ) : ?>
					<?php if ( $this->is_active_tab( $tabs, $tab ) && ! empty( $tab['content'] ) ) : ?>
						<?php echo $tab['content']; ?>
					<?php endif; ?>
				<?php endforeach; ?>
			</div>

			<script>
				var HW_config = {
					selector: ".chipmunk__head h1",
					account:  "yZMVmJ"
				}
			</script>
			<script async src="https://cdn.headwayapp.co/widget.js"></script>
		</div>

		<?php
	}

	/**
	 * Checks if the tab is active
	 *
	 * @param array $tabs Tabs array list
	 * @param array $tab Single tab instance
	 */
	private function is_active_tab( $tabs, $tab ) {
		return ( ! empty( $_GET['tab'] ) && $_GET['tab'] == $tab['slug'] ) || ( empty( $_GET['tab'] ) && $tabs[0] == $tab );
	}

	/**
	 * Is valid license activated
	 *
	 * @return bool
	 */
	protected static function is_valid_license() {
		return ! empty( self::$license ) && 'valid' == self::$license->license;
	}

	/**
	 * Get the price ID if the license is valid and activated
	 *
	 * @return int
	 */
	protected static function get_license_price() {
		return self::is_valid_license() ? (int) self::$license->price_id : 0;
	}

	/**
	 * Adds setting error using Settings API
	 *
	 * @param string $message Error message
	 * @param string $type Error type
	 */
	protected function add_settings_error( $setting, $message, $type = 'error' ) {
		$setting = THEME_SLUG . '_' . $setting;
		$errors = get_settings_errors( $setting );

		if ( ! empty( $message ) && ! Helpers::find_key_value( $errors, 'code', $setting ) ) {
			add_settings_error( $setting, $setting, $message, $type );
		}
	}
}
